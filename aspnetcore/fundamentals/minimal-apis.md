---
title: Minimal APIs overview
author: rick-anderson
description: Provides an overview of minimal APIs in ASP.NET Core 6.0.
ms.author: riande
monikerRange: '>= aspnetcore-6.0'
ms.date: 10/15/2021
no-loc: [Home, Privacy, Kestrel, appsettings.json, "ASP.NET Core Identity", cookie, Cookie, Blazor, "Blazor Server", "Blazor WebAssembly", "Identity", "Let's Encrypt", Razor, SignalR]
uid: fundamentals/minimal-apis.md
---

<!-- TODO - add to TOC, not doing that until this merges to prevent merge conflicts -->

# Minimal APIs overview

This document provides an overview of minimal APIs. The minimal APIs consist of:

* New hosting APIs
* <xref:Microsoft.AspNetCore.Builder.WebApplication> and <xref:Microsoft.AspNetCore.Builder.WebApplicationBuilder>
* New routing APIs

## `WebApplication`

The following code is generated by an ASP.NET Core template:

[!code-csharp[](minimal-apis/samples/WebMinAPIs/Program.cs?name=snippet_default)]

The preceding code can be created via `dotnet new web` on the command line or selecting the Empty Web template in Visual Studio.

The following code creates an app without explicitly creating a <xref:Microsoft.AspNetCore.Builder.WebApplicationBuilder>:

[!code-csharp[](minimal-apis/samples/WebMinAPIs/Program.cs?name=snippet_create)]

[`WebApplication.Create`](xref:Microsoft.AspNetCore.Builder.WebApplication.Create%2A) Initializes a new instance of the WebApplication class with preconfigured defaults.
### Working with ports

When a web app is created with Visual Studio or `dotnet new`, a *Properties/launchSettings.json* file is created that specifies the ports the app responds to. In the samples that follow, running the app from Visual Studio returns an error dialog `Unable to connect to web server 'AppName'`. Run the following samples from the command line.

The following sections set the port the app responds to.

[!code-csharp[](minimal-apis/samples/WebMinAPIs/Program.cs?name=snippet_p1)]

In the preceding code, the app responds to port `3000`.

#### Multiple ports

In the following code, the app responds to port `3000` and `4000`.

[!code-csharp[](minimal-apis/samples/WebMinAPIs/Program.cs?name=snippet_pm)]

#### Read the port from environment

The following code reads the port from the environment:

[!code-csharp[](minimal-apis/samples/WebMinAPIs/Program.cs?name=snippet_pe)]

The preferred way to set the port from the environment is to use the `ASPNETCORE_URLS` environment variable, which is shown in the following section.

#### Set the ports via the ASPNETCORE_URLS environment variable

The `ASPNETCORE_URLS` environment variable is available to set the port:

```
ASPNETCORE_URLS=http://localhost:3000
```

`ASPNETCORE_URLS` supports multiple URLs:

```
ASPNETCORE_URLS=http://localhost:3000;https://localhost:5000
```

### Listen on all interfaces

The following samples demonstrate listening on all interfaces

#### http://*:3000

[!code-csharp[](minimal-apis/samples/WebMinAPIs/Program.cs?name=snippet_i1)]

#### http://+:3000

[!code-csharp[](minimal-apis/samples/WebMinAPIs/Program.cs?name=snippet_ip)]

#### `http://0.0.0.0:3000`

[!code-csharp[](minimal-apis/samples/WebMinAPIs/Program.cs?name=snippet_i0)]

### Listen on all interfaces using ASPNETCORE_URLS

The preceding samples can use `ASPNETCORE_URLS`

```
ASPNETCORE_URLS=http://*:3000;https://+:5000;http://0.0.0.0:5005
```

### Specify HTTPS with development certificate

[!code-csharp[](minimal-apis/samples/WebMinAPIs/Program.cs?name=snippet_cert)]

For more information on the development certificate, see [Trust the ASP.NET Core HTTPS development certificate on Windows and macOS](xref:security/enforcing-ssl#trust).

### Specify HTTPS using a custom certificate

The following sections show how to specify the custom certificate using the *appsetting.json* file and via configuration.

#### Specify the custom certificate with appsetting.json

[!code-json[](minimal-apis/samples/WebMinAPIs/appsettings.json?highlight=9-16)]

#### Specify the custom certificate via configuration

[!code-csharp[](minimal-apis/samples/WebMinAPIs/Program.cs?name=snippet_cert2)]

#### Use the certificate APIs

[!code-csharp[](minimal-apis/samples/WebMinAPIs/Program.cs?name=snippet_cert3)]

### Read the environment

[!code-csharp[](minimal-apis/samples/WebMinAPIs/Program.cs?name=snippet_re)]

For more information using the environment, see <xref:fundamentals/environments?view=aspnetcore-6.0>

### Configuration

The following code reads from the configuration system:

[!code-csharp[](minimal-apis/samples/WebMinAPIs/Program.cs?name=snippet_CONFIG)]

For more information, see <xref:fundamentals/configuration/index?view=aspnetcore-6.0>

### Logging

The following code writes a message to the log on application startup:

[!code-csharp[](minimal-apis/samples/WebMinAPIs/Program.cs?name=snippet_log)]

For more information, see <xref:fundamentals/logging/index?view=aspnetcore-6.0>

## WebApplicationBuilder

This section contains sample code using <xref:Microsoft.AspNetCore.Builder.WebApplicationBuilder>.

### Change the content root, application name, and environment

The following code sets the content root, application name, and environment:

```csharp
var builder = WebApplication.CreateBuilder(new WebApplicationOptions
{
    ApplicationName = typeof(Program).Assembly.FullName,
    ContentRootPath = Directory.GetCurrentDirectory(),
    EnvironmentName = Environments.Staging
});

Console.WriteLine($"Application Name: {builder.Environment.ApplicationName}");
Console.WriteLine($"Environment Name: {builder.Environment.EnvironmentName}");
Console.WriteLine($"ContentRoot Path: {builder.Environment.ContentRootPath}");

var app = builder.Build();
```

<!--TODO: Snippet will be displayed when [PR #23461](https://github.com/dotnet/AspNetCore.Docs/pull/23461) merges.
 Duplicate sample in 50-to-60-samples doc. Once PR #23461 merges, remove this comment AND delete the inline snippet above.

[!code-csharp[](~/migration/50-to-60-samples/samples/Web6Samples/Program.cs?name=snippet_root)]

-->

<!-- TODO, uncomment the following link when article is updated for .NET 6
For more information, see <xref:fundamentals/index/?view=aspnetcore-6.0>
-->

### Change the content root, app name, and environment by environment variables or command line

The following table shows the environment variable and command-line argument used to change the content root, app name, and environment:

| feature   | Environment variable | Command-line argument |
| ------------- | ------------- | -- |
| Application name | ASPNETCORE_APPLICATIONNAME  | --applicationName |
| Environment name |  ASPNETCORE_ENVIRONMENT | --environment |
| Content root  | ASPNETCORE_CONTENTROOT  | --contentRoot |

### Add configuration providers

The following sample adds the INI configuration provider:

```csharp
var builder = WebApplication.CreateBuilder(args);

builder.Configuration.AddIniFile("appsettings.ini");

var app = builder.Build();
```
<!-- Duplicate sample in 50-to-60-samples doc. Once PR #23461 (Migrate to .NET 6 ) merges, remove this comment so the snippet is displayed 
[!code-csharp[](~/migration/50-to-60-samples/samples/Web6Samples/Program.cs?name=snippet_conf)]
-->

For detailed information, see [File configuration providers](xref:fundamentals/configuration/index?view=aspnetcore-6.0#file-configuration-provider) in <xref:fundamentals/configuration/index?view=aspnetcore-6.0>.

### Read configuration

By default the <xref:Microsoft.AspNetCore.Builder.WebApplicationBuilder> reads configuration from:

appSettings.json
appSettings.{environment}.json
environment variables
The command line

For more information, see <xref:Microsoft.AspNetCore.Builder.WebApplicationBuilder>.
